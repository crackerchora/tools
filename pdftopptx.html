<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Convert PDF to PowerPoint (PPTX) online for free. No registration required. Preserve your PDF layout in PowerPoint slides.">
    <title>Free PDF to PowerPoint Converter | No API | Preserve Layout</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Google AdSense (if available) -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-XXXXXXXXXXXXXXXX" crossorigin="anonymous"></script>
    
    <!-- Primary Leaderboard Ad -->
    <script type="text/javascript">
        atOptions = {
            'key' : '320f56a3237c4712c5614b237fda24ab',
            'format' : 'iframe',
            'height' : 90,
            'width' : 728,
            'params' : {}
        };
    </script>
    <script type="text/javascript" src="//margaretnerves.com/320f56a3237c4712c5614b237fda24ab/invoke.js"></script>
    
    <style>
        :root {
            --primary-color: #4361ee;
            --secondary-color: #3f37c9;
            --accent-color: #4895ef;
            --light-color: #f8f9fa;
            --dark-color: #212529;
            --success-color: #4cc9f0;
            --warning-color: #f72585;
            --border-radius: 8px;
            --box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            line-height: 1.6;
            color: var(--dark-color);
            background-color: #f5f7ff;
        }

        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 60px 0;
            text-align: center;
            margin-bottom: 40px;
        }

        header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .converter-box {
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 30px;
            margin-bottom: 40px;
        }

        .upload-area {
            border: 2px dashed #ccc;
            border-radius: var(--border-radius);
            padding: 40px;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            margin-bottom: 20px;
        }

        .upload-area:hover {
            border-color: var(--primary-color);
            background-color: rgba(67, 97, 238, 0.05);
        }

        .upload-area svg {
            margin-bottom: 15px;
            color: var(--primary-color);
        }

        .upload-area h2 {
            margin-bottom: 10px;
            color: var(--dark-color);
        }

        .upload-area p {
            margin: 10px 0;
            color: #666;
        }

        .btn-primary {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: var(--border-radius);
            font-size: 1rem;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 500;
        }

        .btn-primary:hover {
            background-color: var(--secondary-color);
            transform: translateY(-2px);
        }

        .options-section {
            margin-top: 30px;
        }

        .options-section h3 {
            margin-bottom: 20px;
            color: var(--dark-color);
        }

        .option-group {
            margin-bottom: 15px;
        }

        .option-group label {
            display: flex;
            align-items: center;
            cursor: pointer;
        }

        .option-group input {
            margin-right: 10px;
        }

        .progress-section {
            margin-top: 30px;
            text-align: center;
        }

        .progress-bar {
            width: 100%;
            height: 10px;
            background-color: #e9ecef;
            border-radius: 5px;
            margin: 20px 0;
            overflow: hidden;
        }

        .progress {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-color), var(--accent-color));
            width: 0%;
            transition: width 0.3s ease;
        }

        .features-section {
            margin-bottom: 60px;
        }

        .features-section h2 {
            text-align: center;
            margin-bottom: 40px;
            color: var(--dark-color);
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
        }

        .feature-card {
            background-color: white;
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--box-shadow);
            transition: var(--transition);
        }

        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }

        .feature-icon {
            font-size: 2rem;
            margin-bottom: 15px;
        }

        .feature-card h3 {
            margin-bottom: 10px;
            color: var(--primary-color);
        }

        .feature-card p {
            color: #666;
            font-size: 0.9rem;
        }

        footer {
            background-color: var(--dark-color);
            color: white;
            padding: 30px 0;
            text-align: center;
        }

        footer nav {
            margin-top: 15px;
        }

        footer nav a {
            color: white;
            text-decoration: none;
            margin: 0 10px;
            opacity: 0.8;
            transition: var(--transition);
        }

        footer nav a:hover {
            opacity: 1;
            text-decoration: underline;
        }

        @media (max-width: 768px) {
            header {
                padding: 40px 0;
            }
            
            header h1 {
                font-size: 2rem;
            }
            
            .converter-box {
                padding: 20px;
            }
            
            .upload-area {
                padding: 30px 20px;
            }
            
            .features-grid {
                grid-template-columns: 1fr;
            }
        }

        .highlight {
            border-color: var(--primary-color);
            background-color: rgba(67, 97, 238, 0.05);
        }

        .hidden {
            display: none !important;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .fade-in {
            animation: fadeIn 0.5s ease forwards;
        }

        /* Ad container styling */
        .ad-container {
            margin: 20px auto;
            text-align: center;
            background: #f8f9fa;
            padding: 10px;
            border-radius: var(--border-radius);
        }
        
        /* Responsive ads */
        .ad-responsive {
            width: 100%;
            height: auto;
            margin: 0 auto;
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <h1>PDF to PowerPoint Converter</h1>
            <p>Transform your PDF files into editable PowerPoint presentations in seconds</p>
        </div>
    </header>

    <main class="container">
        <!-- Top Banner Ad -->
        <div class="ad-container">
            <script type="text/javascript">
                atOptions = {
                    'key' : 'f5886eb990bdd018205d24ac8905345e',
                    'format' : 'iframe',
                    'height' : 60,
                    'width' : 468,
                    'params' : {}
                };
            </script>
            <script type="text/javascript" src="//margaretnerves.com/f5886eb990bdd018205d24ac8905345e/invoke.js"></script>
        </div>

        <div class="converter-box">
            <div class="upload-area" id="dropArea">
                <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                    <polyline points="17 8 12 3 7 8"></polyline>
                    <line x1="12" y1="3" x2="12" y2="15"></line>
                </svg>
                <h2>Drag & Drop PDF File</h2>
                <p>or</p>
                <button id="selectFileBtn" class="btn-primary">Select File</button>
                <input type="file" id="fileInput" accept=".pdf" style="display: none;">
            </div>
            
            <div class="options-section hidden" id="optionsSection">
                <h3>Conversion Options</h3>
                <div class="option-group">
                    <label>
                        <input type="checkbox" id="preserveLayout" checked>
                        Preserve original layout
                    </label>
                </div>
                <div class="option-group">
                    <label>
                        <input type="checkbox" id="extractImages" checked>
                        Extract images
                    </label>
                </div>
                <div class="option-group">
                    <label>
                        <input type="checkbox" id="extractText" checked>
                        Extract text
                    </label>
                </div>
                <button id="convertBtn" class="btn-primary">Convert to PowerPoint</button>
            </div>
            
            <div class="progress-section hidden" id="progressSection">
                <h3>Converting your PDF...</h3>
                <div class="progress-bar">
                    <div class="progress" id="conversionProgress"></div>
                </div>
                <p id="progressText">Processing pages: 0/0</p>
            </div>
        </div>
        
        <!-- Middle Rectangle Ad -->
        <div class="ad-container">
            <script type="text/javascript">
                atOptions = {
                    'key' : '5b1c3891b0a7bba7b212ad28809aad22',
                    'format' : 'iframe',
                    'height' : 300,
                    'width' : 160,
                    'params' : {}
                };
            </script>
            <script type="text/javascript" src="//margaretnerves.com/5b1c3891b0a7bba7b212ad28809aad22/invoke.js"></script>
        </div>
        
        <div class="features-section">
            <h2>Why Use Our PDF to PPTX Converter?</h2>
            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon">🔒</div>
                    <h3>Privacy Guaranteed</h3>
                    <p>Your files are processed in your browser. No server upload means maximum privacy.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">⚡</div>
                    <h3>Fast Conversion</h3>
                    <p>Convert PDF to PowerPoint in seconds without quality loss.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">💯</div>
                    <h3>No API Needed</h3>
                    <p>Everything happens in your browser - no external APIs or services.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">🆓</div>
                    <h3>Completely Free</h3>
                    <p>No hidden charges, no watermarks, no registration required.</p>
                </div>
            </div>
        </div>
        
        <!-- Bottom Banner Ad -->
        <div class="ad-container">
            <!-- Google AdSense Responsive Ad -->
            <ins class="adsbygoogle"
                 style="display:block"
                 data-ad-client="ca-pub-XXXXXXXXXXXXXXXX"
                 data-ad-slot="XXXXXXXXXX"
                 data-ad-format="auto"
                 data-full-width-responsive="true"></ins>
            <script>
                 (adsbygoogle = window.adsbygoogle || []).push({});
            </script>
        </div>
    </main>

    <footer>
        <div class="container">
            <!-- Footer Ad Container -->
            <div class="ad-container">
                <script async="async" data-cfasync="false" src="//margaretnerves.com/45a039882ceafcd0fc25290e2ae89886/invoke.js"></script>
                <div id="container-45a039882ceafcd0fc25290e2ae89886"></div>
            </div>
            
            <p>&copy; 2023 PDF to PPTX Converter. All rights reserved.</p>
            <nav>
                <a href="/privacy">Privacy Policy</a>
                <a href="/terms">Terms of Service</a>
                <a href="/contact">Contact</a>
            </nav>
        </div>
    </footer>

    <script>
        // Set PDF.js worker path
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.worker.min.js';

        document.addEventListener('DOMContentLoaded', function() {
            const dropArea = document.getElementById('dropArea');
            const fileInput = document.getElementById('fileInput');
            const selectFileBtn = document.getElementById('selectFileBtn');
            const optionsSection = document.getElementById('optionsSection');
            const progressSection = document.getElementById('progressSection');
            const convertBtn = document.getElementById('convertBtn');
            
            // File selection via button
            selectFileBtn.addEventListener('click', () => fileInput.click());
            
            // File input change handler
            fileInput.addEventListener('change', handleFiles);
            
            // Drag and drop handlers
            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                dropArea.addEventListener(eventName, preventDefaults, false);
            });
            
            function preventDefaults(e) {
                e.preventDefault();
                e.stopPropagation();
            }
            
            ['dragenter', 'dragover'].forEach(eventName => {
                dropArea.addEventListener(eventName, highlight, false);
            });
            
            ['dragleave', 'drop'].forEach(eventName => {
                dropArea.addEventListener(eventName, unhighlight, false);
            });
            
            function highlight() {
                dropArea.classList.add('highlight');
            }
            
            function unhighlight() {
                dropArea.classList.remove('highlight');
            }
            
            // Handle dropped files
            dropArea.addEventListener('drop', function(e) {
                const dt = e.dataTransfer;
                const files = dt.files;
                handleFiles({ target: { files } });
            });
            
            // Process selected files
            function handleFiles(e) {
                const files = e.target.files;
                if (files.length === 0) return;
                
                const file = files[0];
                if (file.type !== 'application/pdf') {
                    alert('Please select a PDF file.');
                    return;
                }
                
                // Show options section
                dropArea.style.display = 'none';
                optionsSection.classList.remove('hidden');
                
                // Set up conversion
                convertBtn.addEventListener('click', () => {
                    startConversion(file);
                });
            }
            
            // Start the conversion process
            function startConversion(file) {
                optionsSection.classList.add('hidden');
                progressSection.classList.remove('hidden');
                
                const preserveLayout = document.getElementById('preserveLayout').checked;
                const extractImages = document.getElementById('extractImages').checked;
                const extractText = document.getElementById('extractText').checked;
                
                // Initialize PDF.js
                initializePDFJS(file, preserveLayout, extractImages, extractText);
            }
            
            // Update progress
            function updateProgress(current, total) {
                const progressBar = document.getElementById('conversionProgress');
                const progressText = document.getElementById('progressText');
                
                const percentage = Math.round((current / total) * 100);
                progressBar.style.width = `${percentage}%`;
                progressText.textContent = `Processing pages: ${current}/${total}`;
            }
            
            // PDF.js for processing PDF files
            let pdfDoc = null;
            const scale = 1.5;

            // Initialize PDF.js
            async function initializePDFJS(file, preserveLayout, extractImages, extractText) {
                const loadingTask = pdfjsLib.getDocument(URL.createObjectURL(file));
                
                try {
                    pdfDoc = await loadingTask.promise;
                    const totalPages = pdfDoc.numPages;
                    
                    // Process each page
                    const slides = [];
                    for (let i = 1; i <= totalPages; i++) {
                        updateProgress(i, totalPages);
                        const page = await pdfDoc.getPage(i);
                        const slideContent = await processPage(page, preserveLayout, extractImages, extractText);
                        slides.push(slideContent);
                    }
                    
                    // Generate PPTX
                    generatePPTX(slides, file.name.replace('.pdf', ''));
                    
                } catch (error) {
                    console.error('Error loading PDF:', error);
                    alert('Error processing PDF file. Please try another file.');
                    resetUI();
                }
            }

            // Process individual PDF page
            async function processPage(page, preserveLayout, extractImages, extractText) {
                const viewport = page.getViewport({ scale });
                const canvas = document.createElement('canvas');
                const context = canvas.getContext('2d');
                canvas.height = viewport.height;
                canvas.width = viewport.width;
                
                // Render PDF page to canvas
                await page.render({
                    canvasContext: context,
                    viewport: viewport
                }).promise;
                
                // Extract content based on options
                const pageContent = {
                    image: null,
                    text: null
                };
                
                if (preserveLayout) {
                    pageContent.image = canvas.toDataURL('image/png');
                }
                
                if (extractText) {
                    const textContent = await page.getTextContent();
                    pageContent.text = textContent.items.map(item => item.str).join(' ');
                }
                
                return pageContent;
            }
            
            // pptxgen.js for generating PowerPoint presentations
            function generatePPTX(slides, fileName) {
                const pptx = new PptxGenJS();
                
                slides.forEach((slideContent, index) => {
                    let slide = pptx.addSlide();
                    
                    // Add slide title
                    slide.addText(`Slide ${index + 1}`, {
                        x: 0.5,
                        y: 0.2,
                        w: 9,
                        h: 0.5,
                        fontSize: 18,
                        bold: true,
                        color: '363636'
                    });
                    
                    // Add content based on what was extracted
                    if (slideContent.image) {
                        slide.addImage({
                            data: slideContent.image,
                            x: 0.5,
                            y: 1,
                            w: 9,
                            h: 5.5
                        });
                    }
                    
                    if (slideContent.text) {
                        slide.addText(slideContent.text, {
                            x: 0.5,
                            y: 6.5,
                            w: 9,
                            h: 2,
                            fontSize: 12,
                            color: '000000'
                        });
                    }
                });
                
                // Download the presentation
                pptx.writeFile({ fileName: `${fileName}.pptx` }).then(() => {
                    // Show completion message
                    document.getElementById('progressText').textContent = 'Conversion complete! Your download should start automatically.';
                    
                    // Reset UI after a delay
                    setTimeout(resetUI, 3000);
                }).catch(error => {
                    console.error('Error generating PPTX:', error);
                    alert('Error generating PowerPoint file. Please try again.');
                    resetUI();
                });
            }
            
            function resetUI() {
                document.getElementById('dropArea').style.display = 'block';
                document.getElementById('progressSection').classList.add('hidden');
                document.getElementById('optionsSection').classList.add('hidden');
                document.getElementById('fileInput').value = '';
                document.getElementById('conversionProgress').style.width = '0%';
            }
        });
    </script>
</body>
</html>
